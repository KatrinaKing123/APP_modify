%% Electric Vehicle Parameters 
% Authors    : Wei Zhou, Lin Yang, Yishan Cai, Tianxing Ying
% Date        : 2018-03-20 21:21:40
% Organization: Shanghai JiaoTong University

%% Simulation Step Time
Ts = 1;                                                                    % Unit: s

%% Vehicle Parameters
Par_Veh.Gravity = 9.81;                                                    % Gravitational acceleration, Unit: m/s^2
Par_Veh.Air_Density =1.2;                                                  % Air Density, Unit: kg/m^3
Par_Veh.M_F = 2840;                                                        % Weight, Unit: kg      
Par_Veh.Cd = 0.188;                                                         % Air Resistance Coefficient
Par_Veh.A_F = 2.22;                                                        % Windward Area, Unit: m^2
Par_Veh.Mu = 0.01;                                                       % Rolling Resistance Coefficient
Par_Veh.Grade = 0;                                                         % Rotation Coefficient
Par_Veh.mt2m_f = 0.08;
Par_Veh.L = 3.76;                                                         % Front and back axis length, Unit: m
Par_Veh.a = 1.735;                                                         % Center line distance of the center of mass to the center of the front axis, Unit: m
Par_Veh.b = Par_Veh.L - Par_Veh.a ;                                        % Center line distance of the center of mass to the center of the rear axle, Unit: m
Par_Veh.hg = 0.77;                                                        % Centroid Height, Unit: m
Par_Veh.Coefficient = 0.8;                                                 % Road adhesion coefficient

%% Brake Parameters
% Par_Brake.Beta = (Par_Veh.Coefficient * Par_Veh.hg + Par_Veh.b) / Par_Veh.L; % Braking force distribution
Par_Brake.Brake_Speed_Limit = 10;                                            % When Speed is lower than 10 km/h, mechanical braking 
Par_Brake.Elec_Brake_Dec_Limit = -2;                                         % When Dec is lower than -2 m/s^2, mechanical braking 

%% Wheel Parameters  
Par_Wheel.R = 0.346;                                           % Wheel Radius, Unit: m

%% Final Parameters
Par_Finala.Ratio = 12.7;     % Drive ratio of main decelerator
Par_Finalb.Ratio = 12.7;      
Par_Finala.Eff = 0.95;                                          % Efficiency
Par_Finalb.Eff = 0.95;    
%% Gearbox Parameters 
% Par_Gear.Index = [1 2 3 4 5];                                       % Drive ratio of main decelerator
% Par_Gear.Ratio = [6.9 4.13 2.45 1.49 1.00];                                          % Efficiency
% Par_Gear.Eff = 0.97;


%% Motor Parameters
Motor_PE_50.mc_map_spd =[1000 
1500 
2000 
2500 
3000 
3500 
4000 
4500 
5000 
5500 
6000 
6500 
7000 
7500 
8000 
8500 
9000 
9500 
10000 
10500 
11000 
11500 
12000 
12500 
13000 
13500 
14000 
14500 
15000 
]' ;
% w_EM_row = mc_map_spd *(2*pi/60);
% mc_map_trq=[-125 -105 -95 -85 -75 -65 -55 -45 -30 -15 -5 ...
% 	0 5 15 30 45 55 65 75 85 95 105 125];
% mc_map_trq=[-125 -105 -95 -85 -75 -65 -55 -45 -30 -15 -5 ...
%  	0 5 15 30 45 55 65 75 85 95 105 125]


Speed1 =  Motor_PE_50.mc_map_spd*(2*pi/60); % Unit: rad/s 和转矩相同长度
W_Row1= [0
1000 
1500 
2000 
2500 
3000 
3500 
4000 
4500 
5000 
5500 
6000 
6500 
7000 
7500 
8000 
8500 
9000 
9500 
10000 
10500 
11000 
11500 
12000 
12500 
13000 
13500 
14000 
14500 
15000 
]'*(2*pi/60);%和map_spd相同长度
% 电机转速换算为角速度
Torq_Max1 = [185 
185 
185 
185 
185 
185 
185 
185 
172 
158 
145 
135 
125 
115 
108 
100 
94 
90 
85 
80 
76 
72 
68 
65 
62 
59 
56 
53 
49 
]';  ;     % Unit: Nm
Torq_Min1 = -1*Torq_Max1;                                           % Unit: Nm
%最大力矩（正）和最小力矩（负）
Motor_PE_50.mc_map_trq = fliplr([190
180
170
160
150
140
130
120
110
100
90
80
70
60
50
40
30
20
10
-10
-20
-30
-40
-50
-60
-70
-80
-90
-100
-110
-120
-130
-140
-150
-160
-170
-180
-190
]');
 T_col1=Motor_PE_50.mc_map_trq;                 
Eff_map_1=0.01 * [...
55.98 	61.14 	69.88 	75.04 	78.44 	81.09 	83.14 	84.33 	85.92 	87.36 	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
58.56 	63.44 	71.76 	76.64 	79.87 	82.40 	84.29 	85.63 	86.87 	87.81 	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
60.84 	65.45 	73.47 	78.08 	81.17 	83.45 	85.32 	86.57 	87.68 	88.58 	89.57 	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
62.81 	67.19 	74.96 	79.34 	82.22 	84.43 	86.19 	87.36 	88.41 	89.15 	89.98 	90.42 	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
64.61 	68.84 	76.27 	80.50 	83.27 	85.27 	86.94 	88.06 	88.99 	89.72 	90.49 	90.66 	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
66.42 	70.46 	77.43 	81.47 	84.12 	86.07 	87.58 	88.62 	89.52 	90.22 	90.98 	91.37 	90.85 	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
68.00 	71.79 	78.55 	82.35 	84.86 	86.71 	88.22 	89.14 	89.97 	90.64 	91.33 	91.91 	91.61 	90.83 	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
69.55 	73.17 	79.58 	83.20 	85.56 	87.29 	88.74 	89.64 	90.40 	91.07 	91.71 	92.19 	92.27 	91.56 	89.89 	90.00 	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
70.91 	74.39 	80.44 	83.92 	86.17 	87.86 	89.26 	90.10 	90.79 	91.41 	91.96 	92.56 	92.86 	92.64 	91.59 	90.96 	90.54 	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
72.24 	75.55 	81.34 	84.65 	86.72 	88.34 	89.67 	90.43 	91.11 	91.74 	92.24 	92.80 	93.11 	92.95 	92.58 	92.37 	91.23 	89.66 	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
73.42 	76.50 	82.10 	85.19 	87.29 	88.75 	90.04 	90.76 	91.42 	91.98 	92.44 	92.95 	93.39 	93.38 	93.17 	93.14 	92.67 	91.68 	90.04 	91.25 	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
74.80 	77.74 	82.77 	85.71 	87.77 	89.17 	90.41 	91.02 	91.66 	92.27 	92.71 	93.06 	93.42 	93.75 	93.74 	93.83 	93.45 	92.99 	92.38 	91.47 	90.85 	90.33 	nan	nan	nan	nan	nan	nan	nan	nan
75.78 	78.44 	83.56 	86.23 	88.21 	89.48 	90.66 	91.30 	91.88 	92.46 	92.92 	93.21 	93.69 	93.94 	93.83 	94.00 	93.91 	93.71 	93.27 	92.64 	92.36 	91.17 	90.39 	90.04 	90.31 	89.99 	nan	nan	nan	nan
77.14 	79.66 	84.21 	86.73 	88.62 	89.80 	90.96 	91.56 	92.07 	92.58 	93.03 	93.34 	93.66 	94.03 	94.07 	94.44 	94.31 	94.21 	93.82 	94.06 	93.72 	93.50 	92.83 	92.60 	91.45 	90.64 	90.48 	90.33 	90.07 	nan
78.09 	80.40 	84.94 	87.25 	89.04 	90.21 	91.30 	91.76 	92.17 	92.71 	93.20 	93.49 	93.73 	93.83 	94.24 	94.67 	94.41 	94.59 	94.34 	94.01 	93.90 	93.78 	93.81 	93.45 	93.11 	92.61 	92.53 	91.69 	90.79 	nan
79.45 	81.66 	85.65 	87.86 	89.31 	90.47 	91.56 	91.93 	92.21 	92.86 	93.18 	93.55 	93.76 	93.98 	94.00 	94.45 	94.45 	94.49 	94.66 	94.42 	94.36 	94.13 	93.84 	93.59 	93.44 	93.26 	93.15 	93.10 	92.97 	87.87 
80.83 	82.73 	86.34 	88.25 	89.71 	90.77 	91.78 	92.08 	92.21 	92.86 	93.23 	93.29 	93.53 	93.86 	93.92 	94.25 	94.49 	94.31 	94.41 	94.34 	94.23 	94.62 	94.04 	93.65 	93.14 	93.62 	92.98 	92.94 	92.52 	91.58 
82.55 	84.26 	86.97 	88.68 	89.91 	90.94 	91.94 	91.89 	91.97 	92.54 	92.96 	93.14 	93.07 	93.23 	93.27 	93.32 	93.64 	93.84 	93.86 	93.93 	93.80 	93.95 	93.58 	93.13 	93.23 	92.87 	92.48 	92.75 	91.40 	93.22 
83.66 	84.84 	87.12 	88.31 	89.24 	90.13 	91.85 	91.07 	90.91 	91.62 	91.68 	91.92 	91.44 	91.96 	92.25 	91.70 	92.20 	92.49 	92.23 	92.04 	92.38 	92.09 	90.84 	91.62 	91.43 	90.83 	89.21 	89.59 	90.96 	89.23 
84.52 	86.26 	87.38 	89.12 	89.71 	89.76 	91.01 	90.86 	90.51 	90.96 	91.11 	91.02 	90.87 	90.66 	90.23 	90.22 	89.88 	90.13 	90.29 	91.66 	90.66 	88.18 	88.89 	88.81 	89.35 	88.52 	88.40 	88.67 	88.33 	87.64 
81.40 	83.53 	86.46 	88.59 	90.01 	90.59 	91.69 	91.86 	92.04 	92.44 	92.32 	92.62 	92.80 	93.04 	92.47 	92.93 	92.94 	93.19 	93.19 	93.63 	93.49 	92.72 	92.72 	92.78 	92.43 	92.63 	92.45 	92.07 	92.36 	91.18 
78.23 	80.83 	85.22 	87.82 	89.12 	90.22 	91.58 	91.73 	91.92 	92.52 	92.76 	92.83 	92.96 	93.22 	93.25 	93.36 	93.50 	93.64 	93.83 	93.62 	93.85 	93.59 	93.44 	93.23 	93.26 	93.35 	92.94 	92.91 	92.95 	93.17 
76.29 	79.15 	84.15 	87.01 	88.60 	89.87 	91.05 	91.28 	91.78 	92.34 	92.76 	92.93 	93.20 	93.50 	93.41 	93.61 	93.57 	93.98 	93.95 	93.95 	93.85 	93.89 	93.93 	93.83 	93.51 	93.43 	93.52 	93.33 	93.18 	93.06 
74.28 	77.39 	83.24 	86.35 	88.07 	89.48 	90.61 	91.16 	91.76 	92.21 	92.64 	92.99 	93.10 	93.43 	93.39 	93.60 	93.96 	94.00 	93.96 	94.20 	94.06 	93.84 	93.64 	93.61 	93.37 	93.22 	93.22 	93.11 	92.72 	92.98 
72.70 	75.83 	82.29 	85.42 	87.55 	89.04 	90.30 	90.87 	91.49 	92.11 	92.45 	92.79 	92.98 	93.40 	93.55 	93.68 	93.83 	93.82 	93.80 	93.97 	93.71 	93.60 	93.37 	93.18 	92.95 	92.64 	92.35 	92.23 	92.48 	92.85 
71.04 	74.54 	81.31 	84.81 	87.04 	88.56 	89.91 	90.52 	91.26 	91.78 	92.31 	92.71 	92.84 	93.18 	93.46 	93.50 	93.61 	93.50 	93.49 	93.40 	93.01 	93.24 	92.73 	92.36 	92.51 	92.43 	nan	nan	nan	nan
68.90 	72.75 	80.25 	84.09 	86.51 	88.13 	89.45 	90.19 	90.91 	91.49 	92.09 	92.49 	92.54 	92.99 	92.99 	93.22 	93.43 	93.29 	92.97 	92.86 	92.57 	92.87 	92.62 	nan	nan	nan	nan	nan	nan	nan
67.01 	71.13 	79.16 	83.28 	85.83 	87.63 	89.00 	89.82 	90.65 	91.27 	91.80 	92.25 	92.36 	93.01 	92.96 	92.94 	92.93 	92.69 	92.26 	92.62 	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
65.09 	69.40 	78.07 	82.38 	85.19 	87.05 	88.53 	89.39 	90.21 	90.96 	91.44 	91.96 	92.06 	92.73 	92.68 	92.55 	92.42 	92.09 	92.20 	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
62.70 	67.36 	76.79 	81.45 	84.40 	86.43 	87.97 	88.98 	89.83 	90.48 	91.17 	91.53 	91.85 	92.36 	92.02 	91.88 	91.99 	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
60.28 	65.25 	75.41 	80.38 	83.57 	85.76 	87.31 	88.39 	89.39 	90.12 	90.53 	91.32 	91.51 	91.93 	91.53 	91.63 	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
57.45 	62.87 	73.84 	79.26 	82.64 	84.97 	86.66 	87.87 	88.89 	89.64 	90.28 	90.83 	91.07 	91.53 	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
54.44 	60.28 	72.08 	77.92 	81.59 	84.07 	85.90 	87.19 	88.31 	89.07 	89.79 	90.42 	90.56 	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
51.12 	57.43 	70.13 	76.43 	80.43 	83.09 	85.02 	86.44 	87.62 	88.43 	89.25 	90.02 	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
47.15 	54.04 	67.88 	74.76 	79.14 	81.94 	83.99 	85.58 	86.86 	87.72 	88.61 	89.91 	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
42.47 	50.02 	65.24 	72.79 	77.50 	80.59 	82.81 	84.48 	85.97 	86.92 	88.14 	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
37.04 	45.38 	62.15 	70.49 	75.70 	79.04 	81.46 	83.27 	84.89 	85.96 	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
30.92 	40.15 	58.57 	67.80 	73.48 	77.23 	79.92 	81.93 	83.64 	85.54 	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
];


mc_map_trq1=5:5:95;
mc_map_trq2=100:10:310;
mc_map_trq_dr = [mc_map_trq1 mc_map_trq2];
mc_map_trq_br = fliplr(-1 * mc_map_trq_dr);
clear mc_map_trq1 ;
Motor_PE_70.mc_map_trq = [mc_map_trq_br mc_map_trq_dr];

Speed2 =   [1000
2000
3000
4000
4178
4621
5000
6000
7000
8000
9000
10000
11000
12000
13000
14000
15000
16000
]'*(2*pi/60); % Unit: rad/s 和转矩相同长度
W_Row2= [0 200 500 1000 1500 2000 2500 3000 3500 4000 4620 5000 5500 6000 6500 7000 7500 8000 8500 9000 9500 10000 10500 11000 11500 12000 12500 13000 13500 14000 14500 15000]*(2*pi/60);%和map_spd相同长度
% 电机转速换算为角速度
Torq_Max2 =-[-314.5
-314
-313.1
-313.5
-312
-307.8
-285.1
-237.5
-204.5
-169.3
-144.7
-127.6
-114.6
-101.8
-94.5
-85.1
-78.1
-73.9
]';  ;     % Unit: Nm
Torq_Min2 = -1*Torq_Max2;                                           % Unit: Nm
%最大力矩（正）和最小力矩（负）

 T_col2=Motor_PE_70.mc_map_trq;                 
Eff_map_2=0.01 * [...
21.58733333	36.938	59.964	74.929	81.645	85.426	87.843	89.585	90.794	91.806	92.583	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
23.21866667	38.148	60.542	75.343	82.008	85.735	88.111	89.835	91.049	92.043	92.799	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
24.31833333	38.963	60.93	75.659	82.244	85.915	88.259	89.941	91.163	92.155	93.117	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
25.38133333	39.844	61.538	76.114	82.601	86.224	88.507	90.177	91.34	92.321	93.458	93.055	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
24.37766667	39.989	63.406	76.535	82.91	86.44	88.744	90.716	91.82	92.727	93.555	93.549	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
25.925	41.133	63.945	77.989	83.887	87.306	89.4	90.864	92.001	92.853	93.691	93.76	92.989	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
27.256	42.094	64.351	78.294	84.149	87.487	89.598	91.021	92.096	92.961	93.826	93.867	93.483	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
28.76	43.222	64.915	78.638	84.439	87.705	89.779	91.168	92.284	93.144	94.072	94.296	93.826	93.751	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
29.20866667	43.704	65.447	79.007	84.714	87.913	89.971	91.329	92.398	93.211	94.134	94.445	94.277	93.388	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
29.93533333	44.398	66.092	79.47	85.066	88.211	90.216	91.543	92.577	93.39	94.222	94.585	94.497	93.922	93.205	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
30.338	44.846	66.608	79.835	85.33	88.399	90.375	91.71	92.68	93.708	94.301	94.746	94.731	94.35	93.355	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
31.20666667	45.632	67.27	80.267	85.645	88.657	90.587	92.101	93.064	93.827	94.44	94.913	94.91	94.852	93.963	93.118	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
31.97233333	46.319	67.839	80.665	85.943	88.888	90.77	92.255	93.193	93.937	94.541	94.994	95.099	95.054	94.579	93.603	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
32.02633333	46.901	69.213	81.011	86.179	89.094	90.944	92.38	93.272	94.015	94.627	95.118	95.265	95.235	94.953	94.393	93.003	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
32.697	47.493	69.687	81.376	86.461	89.591	91.359	92.489	93.384	94.125	94.764	95.157	95.531	95.398	95.199	94.831	93.957	92.615	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
33.51333333	48.194	70.215	81.767	87.151	89.795	91.523	92.637	93.524	94.208	94.847	95.215	95.625	95.577	95.399	95.122	94.591	93.775	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
34.19566667	48.821	70.759	82.148	87.44	90.019	91.655	92.758	93.623	94.308	95.006	95.27	95.733	95.726	95.569	95.374	94.986	94.288	93.715	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
35.042	49.54	71.287	82.988	87.644	90.161	91.79	92.864	93.734	94.381	95.08	95.333	95.758	95.821	95.827	95.615	95.326	94.874	94.272	93.652	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
35.781	50.163	71.736	83.294	87.838	90.33	91.933	92.981	93.794	94.453	95.122	95.37	95.831	95.912	95.966	95.82	95.667	95.392	94.964	94.323	93.419	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
36.554	50.846	72.284	83.606	88.035	90.483	92.062	93.04	93.844	94.528	95.152	95.388	95.769	95.989	96.042	95.974	95.854	95.588	95.248	94.974	94.283	93.533	91.738	nan	nan	nan	nan	nan	nan	nan	nan	nan
37.38	51.512	72.71	83.844	88.248	90.589	92.145	93.099	93.875	94.53	95.156	95.416	95.771	96.059	96.173	96.078	95.934	95.75	95.621	95.26	94.963	94.524	93.647	91.156	nan	nan	nan	nan	nan	nan	nan	nan
38.05266667	52.086	73.136	84.105	88.417	90.769	92.224	93.223	93.937	94.538	95.156	95.403	95.744	96.053	96.202	96.212	96.056	95.947	95.819	95.543	95.185	94.908	94.521	93.903	92.983	91.199	nan	nan	nan	nan	nan	nan
38.15333333	52.232	73.35	84.216	88.509	90.774	92.234	93.239	93.871	94.521	95.146	95.385	95.747	96.054	96.223	96.255	96.113	95.978	95.907	95.686	95.432	95.014	94.736	94.346	93.817	93.497	90.996	nan	nan	nan	nan	nan
38.618	52.576	73.513	84.294	88.574	90.83	92.271	93.263	93.966	94.549	95.119	95.385	95.752	96.042	96.208	96.294	96.119	96.056	95.934	95.699	95.516	95.241	94.688	94.563	94.209	93.899	93.021	90.721	nan	nan	nan	nan
38.99933333	52.888	73.721	84.427	88.591	90.841	92.327	93.247	93.935	94.508	95.099	95.326	95.721	95.938	96.223	96.309	96.14	96.117	96.013	95.799	95.504	95.201	95.076	94.852	94.406	94.195	93.743	93.05	90.307	nan	nan	nan
39.41866667	53.202	73.877	84.515	88.695	90.852	92.309	93.247	93.885	94.495	95.047	95.29	95.603	95.839	96.19	96.234	96.14	96.158	96.019	95.926	95.644	95.286	95.019	94.898	94.56	94.355	94.064	93.628	92.958	91.976	nan	nan
39.758	53.468	74.033	84.563	88.728	90.859	92.279	93.216	93.875	94.5	94.982	95.215	95.624	95.796	96.095	96.253	96.152	96.102	96.118	95.861	95.615	95.233	95.163	94.971	94.812	94.576	94.099	93.943	93.441	93.066	92.263	90.618
39.62866667	53.462	74.212	84.634	88.731	90.91	92.294	93.212	93.874	94.461	94.927	95.189	95.481	95.789	96.075	96.251	96.17	96.098	96.056	95.927	95.63	95.368	95.17	95.061	94.839	94.646	94.337	93.996	93.717	93.324	92.64	91.496
40.056	53.748	74.286	84.653	88.738	90.887	92.283	93.09	93.777	94.378	94.89	95.068	95.438	95.639	96.024	96.169	96.223	96.126	96.054	95.973	95.682	95.385	95.207	94.997	94.796	94.545	94.185	94.123	93.674	93.484	93.005	92.063
40.35633333	53.977	74.408	84.776	88.739	90.941	92.25	93.068	93.709	94.332	94.816	94.954	95.339	95.515	95.714	96.049	96.072	96.124	96.053	95.881	95.609	95.179	95.246	94.903	94.867	94.511	94.262	94.01	93.78	93.56	93.187	92.171
40.87033333	54.301	74.447	84.773	88.748	90.926	92.158	93.009	93.677	94.228	94.68	94.891	95.28	95.45	95.636	95.916	95.97	96.017	95.965	95.855	95.544	95.295	95.092	94.868	94.722	94.611	94.184	93.958	93.798	93.524	93.161	92.009
40.67133333	54.204	74.503	84.658	88.751	90.783	92.09	92.905	93.53	94.068	94.588	94.772	95.092	95.356	95.479	95.753	95.847	95.873	95.807	95.768	95.445	95.178	94.966	94.848	94.578	94.293	94.105	93.647	93.69	93.403	93.343	92.108
40.97366667	54.375	74.477	84.703	88.657	90.689	92.11	92.908	93.503	93.966	94.435	94.531	94.924	95.113	95.147	95.425	95.621	95.673	95.7	95.593	95.321	95.014	94.829	94.663	94.614	94.243	93.935	93.742	93.447	93.34	93.067	91.719
41.02533333	54.364	74.372	84.601	88.53	90.534	92.007	92.728	93.216	93.832	94.186	94.389	94.63	94.79	94.978	95.237	95.279	95.478	95.544	95.352	95.103	94.785	94.768	94.457	94.216	93.98	93.746	93.516	93.369	93.203	92.693	91.631
40.46166667	53.971	74.235	84.473	88.35	90.392	91.772	92.417	93.169	93.604	93.962	94.207	94.528	94.664	94.758	94.925	94.764	95.072	95.146	95.117	94.863	94.402	94.417	94.092	93.919	93.639	93.443	92.94	93.005	92.656	92.308	91.631
40.29266667	53.798	74.056	84.227	88.222	90.147	91.571	92.239	92.75	93.31	93.717	93.896	94.077	94.338	94.509	94.737	94.57	94.706	94.712	94.609	94.406	94.325	94.069	93.596	93.435	93.195	92.692	92.458	92.234	91.889	91.237	91.631
40.038	53.45	73.568	83.815	87.813	89.944	91.341	91.814	92.308	92.985	93.238	93.418	93.474	93.809	94.038	94.021	93.878	93.99	94.11	94.072	93.947	93.312	93.429	93.084	92.637	92.68	92.064	91.364	91.152	91.443	90.399	91.631
39.153	52.677	72.963	83.377	87.314	89.435	90.761	91.59	91.805	92.152	92.749	92.913	92.776	93.336	93.574	93.042	93.089	93.428	92.969	93.084	92.689	92.188	92.405	92.033	91.829	91.395	91.004	90.349	89.928	90.126	90.399	91.631
37.25333333	51	71.62	82.334	86.413	88.439	89.924	90.337	90.856	91.396	91.438	91.848	91.465	91.939	92.126	91.733	91.439	91.57	91.644	91.276	91.07	90.438	90.513	89.96	90.027	89.649	89.341	87.678	89.928	90.126	90.399	91.631
33.54633333	47.823	69.238	79.947	84.486	86.569	88.053	88.457	88.752	89.347	89.52	89.147	89.054	89.533	89.93	89.981	88.889	88.311	88.959	89.234	87.998	86.019	86.875	86.171	86.665	85.651	84.555	83.139	89.928	90.126	90.399	91.631
26.549	40.407	61.194	73.399	78.241	81.024	83.204	82.476	83.637	83.367	83.683	83.186	82.328	82.813	83.016	83.355	82.467	82.683	80.869	81.568	79.079	79.753	77.54	76.56	75.37	74.397	73.91	71.016	89.928	90.126	90.399	91.631
8.734375	8.734375	40.00656108	64.63037886	72.41549112	74.88729462	75.74839413	77.062382	77.77017358	76.77720024	76.63481213	77.38021543	76.77484242	76.55971275	74.81669909	75.45347539	74.93892478	75.24228014	74.11305205	72.85443684	72.87726739	70.57312434	70.88076438	68.99263849	70.67737193	66.79982098	66.33059167	67.56026376	67.56026376	67.56026376	67.56026376	67.56026376
8.734375	8.734375	55.80730853	74.99737509	80.83812973	82.92217754	84.23322495	85.93132369	86.01188684	86.10891055	86.72876446	86.74305839	86.87870863	86.49695963	85.21444214	85.66778035	87.30193374	86.46704309	85.73976267	85.73388203	85.98156555	84.52871018	84.93939574	83.6925137	84.09085176	82.55116108	81.66131785	82.70340903	82.70340903	82.70340903	82.70340903	82.70340903
8.734375	8.734375	60.69360654	77.89253945	83.63721522	85.91286717	87.13154249	88.1803111	88.65798409	89.06860955	89.4430382	89.58807404	89.85856262	89.88279284	90.12337891	89.82062821	89.97255837	89.90218642	89.71828459	89.52791928	89.72955512	89.31282711	89.43023994	88.64148067	88.17797843	87.59328685	87.27907484	87.51586225	87.51586225	87.51586225	87.51586225	87.51586225
13.04493589	13.04493589	63.000063	79.37515875	84.66181837	86.98223823	88.57003676	89.42944017	90.17783068	90.37505648	90.84384851	91.14357848	91.34589035	91.24670371	90.92231597	91.71114657	91.62879343	91.19095386	91.07053413	91.3492281	91.67331298	91.42021301	91.54155987	90.84219802	90.73751452	90.02196536	89.47104717	89.6579549	88.94818768	88.58023598	87.84567272	87.84567272
14.23224172	14.23224172	64.11694932	80.06405124	85.34316487	87.73315085	89.0495739	90.10470166	90.61828858	91.05477855	91.51810228	91.91007518	92.10053695	92.089511	92.05560158	92.27646027	92.56773644	92.62260918	92.71449498	92.64749481	92.91953169	92.39240904	92.51207283	92.13617727	91.81134605	91.41937725	91.10455158	91.24753632	90.24049091	90.0933367	90.08440909	90.08440909
16.49890035	16.49890035	64.62745504	80.46087992	85.6201036	88.09563662	89.48065428	90.58709496	91.18263883	91.49381959	92.02849202	92.26283837	92.50864956	92.64749481	92.59687949	92.98606139	92.79795102	93.02412115	93.30969488	93.64611135	93.42825644	93.08993419	93.19230232	92.76609956	92.86861877	92.14466713	91.83664098	91.97601266	91.36174684	91.0456594	90.45680687	90.45680687
16.78838244	16.78838244	65.00386773	80.74609391	85.8310159	88.16009874	89.75452138	90.82404657	91.40934935	91.86616936	92.35657025	92.68184177	92.90312991	93.02931354	93.0960006	93.106402	93.46231132	93.33233779	94.02384445	93.87379607	93.97524692	93.57863413	93.82535349	93.26705155	93.40905694	92.69730622	92.5377554	92.47699635	92.05729646	91.50386604	91.57593018	91.57593018
17.19013493	17.19013493	65.17247897	80.92448127	86.04889298	88.43218578	89.88036923	91.05975341	91.4921454	92.0445864	92.63376315	92.84792438	93.16365127	93.25661423	93.50600776	93.96200177	93.82447318	94.0618739	94.29870056	94.24271268	94.18235588	94.12650602	94.05656562	93.59702736	93.54361939	93.06567645	93.00422239	92.89622563	92.35145269	91.88727269	92.03696204	92.37277959
17.61894107	17.61894107	65.18819833	81.03727715	86.14600024	88.59750155	90.0203446	91.13610266	91.77342976	92.25347565	92.79795102	93.09426726	93.32188585	93.5479948	93.8561748	93.99821403	94.22584049	94.56801332	94.51617172	94.64229943	94.53582908	94.277364	94.1070185	93.91787821	93.64961931	93.19230232	93.1029346	93.21315051	92.71191626	92.56173868	92.27390586	92.66037194
17.10843497	17.10843497	65.13427431	80.97428257	86.11780916	88.54572501	90.06493682	91.30252178	91.88136278	92.45476651	92.93766671	93.19143384	93.45881737	93.72334742	93.8051105	94.06541309	94.39572576	94.57069632	94.74093092	94.74541906	94.7193938	94.47598893	94.45011145	93.95229103	93.97259759	93.59965555	93.38899317	93.29489584	93.04402843	92.73255005	92.51207283	93.00854749
16.69973214	16.69973214	65.01950585	80.91138585	86.19649353	88.6077071	90.19328421	91.33337596	91.91767853	92.5172082	93.01979461	93.32536957	93.60403621	93.82711416	94.20542435	94.0795725	94.7885268	94.7193938	94.87846069	94.86855961	94.80649993	94.56711901	94.40820218	94.16816551	94.09993413	93.68471347	93.49639104	93.3610927	92.96099357	92.83154787	92.60202428	93.10900271
16.5456901	16.5456901	64.93379999	80.91989739	86.16084507	88.68628999	90.2095568	91.37677385	92.07085773	92.61060021	93.18275001	93.46493196	93.76025503	93.94346482	94.21163702	94.62976106	94.71490813	94.91898664	94.92799711	94.98299804	94.95053077	94.57874626	94.5000945	94.18767837	94.14068384	93.79103358	93.61630422	93.47454221	93.31143625	92.76351796	92.70847819	93.28967377
15.77702644	15.77702644	64.75341898	80.82375572	86.17866561	88.74846909	90.26411279	91.43525926	92.11326247	92.69043249	93.25835362	93.56900246	93.86850899	94.1061329	94.21429985	94.92799711	94.95864551	95.03354684	94.94061465	95.00555783	94.77325499	94.72029098	94.521532	94.33517287	94.11941872	93.91964235	93.63558901	93.64435746	93.29663666	93.09946747	92.98606139	93.46580554
14.86257322	14.86257322	64.50822157	80.75391858	86.10297916	88.71697511	90.24619161	91.45532864	92.1302353	92.76609956	93.26879133	93.60929353	93.94434737	94.16284522	94.360097	94.82717747	94.9577438	95.15562703	95.00826572	94.97848737	94.96766351	94.79212088	94.47509636	94.2951438	94.13270829	93.79191326	93.70666067	93.54361939	93.23226955	92.79106236	93.06134604	93.22792363
14.31067619	14.31067619	64.19226868	80.60485886	86.04593132	88.66270049	90.27959591	91.44612909	92.15825415	92.77556663	93.34192079	93.70666067	93.97348068	94.23649591	94.56622473	94.92799711	95.11037559	95.13118591	95.01548752	94.90637486	94.81998426	94.70683499	94.50991882	94.30136831	94.17614707	94.05125794	93.66891784	93.56199886	93.24357086	92.95667289	92.78847938	93.21141281
13.54064971	13.54064971	63.85002905	80.51205668	85.97639088	88.58965273	90.26166858	91.48042776	92.16844705	92.7678207	93.40469452	93.68910208	94.00705053	94.29336552	94.6969697	94.90997789	95.1782689	95.05070955	94.99743507	95.05703422	94.79661386	94.69876323	94.46170995	94.31115135	94.1592987	93.89583196	93.69261327	93.46580554	93.29315508	92.88759672	nan	nan
12.7358034	12.7358034	63.56228468	80.33935343	85.90327291	88.57239021	90.23316249	91.45365586	92.12853774	92.79881218	93.42651071	93.7189556	94.05214251	94.3031469	94.84606484	95.07691723	95.17192809	95.03715953	94.9893137	95.02903137	94.75080538	94.55907105	94.41622448	94.31648841	94.00881803	93.73388949	93.53049562	93.28706295	92.92384891	nan	nan	nan
11.72212011	11.72212011	63.22751155	80.20146608	85.78389322	88.52691218	90.19816537	91.41269174	92.14891264	92.81776161	93.41516502	93.75761781	94.07780234	94.34763329	94.84246666	95.03715953	95.1239465	95.04528908	94.96946732	94.87666034	94.71759948	94.48848658	94.37256401	94.15043356	93.94876035	93.73301089	93.37765659	93.17319966	nan	nan	nan	nan
10.83244056	10.83244056	64.6	80.00640051	85.66044201	88.46426044	90.08846687	91.42522788	92.15400778	92.83499508	93.46667913	93.76904684	94.06541309	94.32182607	94.79481662	95.14114188	95.25079534	94.95954723	94.97307513	94.78762832	94.67545255	94.41711593	94.27469761	94.15752554	93.83151613	93.66891784	93.33059564	nan	nan	nan	nan	nan
9.836966825	9.836966825	62.39081607	79.82948422	85.54466287	88.35561367	90.10957324	91.37927883	92.09459957	92.82723923	93.46755274	93.77344336	94.11056109	94.35742593	94.73105852	95.09861727	95.16921086	95.00826572	94.93160178	94.74182852	94.61364518	94.42246499	94.22761623	94.03622275	93.74619156	93.51387746	nan	nan	nan	nan	nan	nan
7.682758621	7.682758621	61.57862975	79.42180923	85.33661026	88.19819899	89.95151613	91.32169895	92.03357385	92.79795102	93.42912933	93.77871973	94.09196549	94.53136078	94.87215976	94.96766351	95.02361337	94.86046026	94.81548906	94.65215334	94.46081765	94.23383183	93.9946799	93.83856014	nan	nan	nan	nan	nan	nan	nan	nan
5.419521912	5.419521912	60.76589332	79.03513902	85.04992431	87.99718409	89.82466226	91.23171944	91.97262895	92.74975189	93.41778301	93.71280773	94.0795725	94.60290431	94.79930986	94.99472779	95.05613065	94.74990762	94.65036156	94.43584029	94.32805411	93.90288564	93.69612473	nan	nan	nan	nan	nan	nan	nan	nan	nan
3.204761905	3.204761905	59.70291828	78.54719115	84.74217194	87.77935781	89.6547396	91.12364567	91.85604321	92.67325265	93.22879278	93.66540843	94.04595085	94.62797014	94.83077448	94.85776079	94.65663306	94.5563887	94.46795647	94.25781397	93.96553344	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
0.851864407	0.851864407	58.67167332	78.06584073	84.42737135	87.51739408	89.46944618	90.74080796	91.74311927	92.58659161	93.17233154	93.61016981	94.00705053	94.57159069	94.72029098	94.77415319	94.53761652	94.43940768	94.19921249	93.9381699	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
nan	nan	57.76840646	77.5410192	84.11914636	87.29126476	89.26499206	90.59612249	91.61704077	92.50180379	93.12287563	93.53049562	94.0247285	94.521532	94.67365989	94.62259777	94.42424815	94.18412997	93.96553344	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
nan	nan	56.59597829	77.08139024	83.76051194	87.04205001	89.09797213	90.4273597	91.49549385	92.21094175	93.00768243	93.48852428	94.0282649	94.46349458	94.54566083	94.3912707	94.18945267	93.95405647	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
nan	nan	55.56636013	76.49061078	83.42231714	86.77316627	88.86914019	90.23804797	91.34672476	92.08527096	92.91521487	93.41778301	93.89495033	94.34051265	94.32093642	94.13270829	93.95493921	93.65839039	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
nan	nan	54.52116784	75.98033629	83.0578581	86.52839429	88.68471696	90.09496009	91.23088713	91.97093718	92.80311818	93.14109012	93.84648592	94.23383183	94.20276202	93.98142927	93.79983116	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
nan	nan	53.37062161	75.52128567	82.75610947	86.2879775	88.49714154	89.94504358	91.09957183	91.86363762	92.71879317	93.02498651	93.78223764	94.09462155	93.88525344	93.75849686	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
nan	nan	52.28976898	75.00243758	82.40626288	86.00227046	88.28073273	89.76016085	90.95291368	91.73217873	92.59516468	92.97309359	93.70227041	93.81391073	93.73388949	93.49464276	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
nan	nan	48.96680051	73.27403022	81.23608832	85.72065353	88.05840033	89.55598144	90.78694121	91.59102774	92.46075041	92.82293098	93.57250466	93.65312755	93.49114639	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
nan	nan	47.6467281	72.73150438	80.88520771	85.48177529	87.84104285	89.4166458	90.63635787	91.46453006	92.37619281	92.72051256	93.44833709	93.50163628	93.22444718	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
nan	nan	46.37552114	71.95694097	80.40524242	84.61525444	87.10346149	89.19731338	90.17783068	91.29835389	92.02933895	92.67325265	93.32798253	93.30534173	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
nan	nan	45.07834617	71.38879767	79.99488033	84.33338674	86.85531641	88.62105636	89.96041742	90.86531035	91.87207732	92.6166043	92.99643824	93.06567645	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
nan	nan	43.84964833	70.80698723	79.66032836	83.9757478	86.60633092	88.41029449	89.78756263	90.72022789	91.73302022	92.33610342	92.83844254	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
nan	nan	42.68305696	70.29876977	79.28767949	83.71493391	86.36622735	88.21064703	89.66599417	90.56986559	91.60948708	92.23135313	92.66380644	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
nan	nan	41.80007858	69.8070533	78.92223792	83.44737808	86.12225916	88.02894392	89.49506882	90.4159132	91.48210153	92.14466713	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
nan	nan	37.13344647	67.30018575	77.30066092	83.1635411	85.94461729	87.82869891	88.91259892	90.2861167	91.02411229	92.09629589	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
nan	nan	35.70115279	66.48228912	76.82969929	81.96318214	85.02172305	87.10042679	88.69415594	89.71747966	90.88265232	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
nan	nan	34.82791527	66.04758068	76.54857773	81.70068138	84.83707041	86.89909277	88.57631292	89.58486374	90.78941395	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
nan	nan	33.80971218	65.53122891	76.08844521	81.41399832	84.56516592	86.70470113	88.43922456	89.43743851	90.67251807	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan	nan
];


Par_Motor1.Speed = Speed1;
Par_Motor1.W_Row = W_Row1;
Par_Motor1.T_Col = T_col1;
Par_Motor1.Trq_Min = Torq_Min1;
Par_Motor1.Trq_Max = Torq_Max1;
Par_Motor1.Eff_map = Eff_map_1;%又转置回去？

Par_Motor2.Speed = Speed2;
Par_Motor2.W_Row = W_Row2;
Par_Motor2.T_Col = T_col2;
Par_Motor2.Trq_Min = Torq_Min2;
Par_Motor2.Trq_Max = Torq_Max2;
Par_Motor2.Eff_map = Eff_map_2;
%% Battery Parameters
Par_Batt.ESS_SOC = 0.1:.1:0.9;
% Par_Batt.ESS_SOC = 0:0.05:1;
% Par_Batt.ESS_VOC = fliplr([360.5256 360.234 358.6572 356.616 356.1084 355.8816 355.104 352.1556 349.4124]); 
Par_Batt.ESS_VOC = fliplr([4.125 

3.997 

3.884 

3.780 

3.676 

3.632 

3.602 
3.551 
3.473 
]') * 95.946;
% Par_Batt.ESS_R_D = fliplr([0.259286 0.247857 0.235714 0.227143 0.223571 0.221429 0.22 0.217143 0.212143]);
Par_Batt.ESS_R_D = fliplr([0.63
0.62
0.61
0.60
0.60
0.60
0.61
0.80
1.00
]') * 10^(-3) * 95.945;
Par_Batt.ESS_R_C = fliplr([0.67
0.65
0.65
0.65
0.64
0.64
0.64
0.68
0.71
]')* 10^(-3) * 95.945;
% Par_Batt.Q_Ah = 40;
Par_Batt.Q_Ah = 153;
Par_Batt.Col_Eff = 1;    
Par_Batt.Ts = Ts;
% Par_Batt.SOC_Max = 0.90;
Par_Batt.SOC_Max = 0.975;
% Par_Batt.SOC_Min = 0.20;
Par_Batt.SOC_Min = 0.05;
% Par_Batt.P_Batt_Max = 100000;
Par_Batt.P_Batt_Max = 208000;
% Par_Batt.P_Batt_Min = -20000;
Par_Batt.P_Batt_Min = -10300;
% Par_Batt.I_Max = 2000;
Par_Batt.I_Max = 775;
% Par_Batt.I_Min = -2000;
Par_Batt.I_Min = -320;

%% Other Parameters
Paux =1000;
